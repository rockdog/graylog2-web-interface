function buildHostCssId(e){return"visuals-spread-hosts-"+e.replace(/=/g,"")}function bindMessageSidebarClicks(){$(".message-row").bind("click",function(){$("#gln").show(),target=relative_url_root+"/messages/"+$(this).attr("id")+"?partial=true",stream_id=$("#stream_id").val(),stream_id!=undefined&&(target+="&stream_id="+stream_id),$.get(target,function(e){$("#sidebar-inner").html(e),$("#main-right").is(":visible")||$("#main-left").animate({width:"65%"},700,function(){$("#main-right").show()}),$("#gln").hide()})})}function htmlEncode(e){return $("<div/>").text(e).html()}function notify(e){$.gritter.add({title:"Notification",text:e})}$(document).ajaxSend(function(e,t,n){var r=$("meta[name='csrf-token']").attr("content");t.setRequestHeader("X-CSRF-Token",r)}),$(document).ready(function(){setInterval(function(){$(".notification-flash").hide("drop")},3500),$("#streamrule_rule_type").bind("change",function(){$(".stream-value-field").hide(),$(".stream-value-help").hide(),$(".stream-value-field").attr("disabled",!0),help=null,master=null;switch(this.value){case"1":field=$(".stream-value-message");break;case"2":field=$(".stream-value-host");break;case"3":field=$(".stream-value-severity");break;case"4":field=$(".stream-value-facility");break;case"5":field=$(".stream-value-timeframe"),help=$("#stream-value-timeframe-help");break;case"6":field=$(".stream-value-additional-field"),help=$("#stream-value-additional-field-help");break;case"8":field=$(".stream-value-severity-or-higher");break;case"9":field=$(".stream-value-host-regex"),notify("Remember to possibly escape characters in the regular expression.A typical mistake is forgetting to escape dots in host names.");break;case"10":field=$(".stream-value-fullmessage");break;case"11":field=$(".stream-value-filename"),notify("Remember to possibly escape characters in the regular expression.A typical mistake is forgetting to escape the dot in filenames.");break;case"12":field=$(".stream-value-facility-regex"),notify("Remember to possibly escape characters in the regular expression.")}field.removeAttr("disabled"),field.show(),help!=null&&help.show()}),$("#favoritestreamchooser_id").bind("change",function(){window.location="/streams/show/"+parseInt(this.value,10)}),$("#messages-show-quickfilter").bind("click",function(){var e=$("#messages-show-quickfilter");e.hasClass("messages-show-quickfilter-expanded")?(e.removeClass("messages-show-quickfilter-expanded"),$("#messages-quickfilter").hide()):(e.addClass("messages-show-quickfilter-expanded"),$("#messages-quickfilter").fadeIn(800))}),$("#messages-show-message-full").css("width",parseInt($("#content").css("width"))-15,10),$("#messages-show-message-full").css("height",parseInt($("#messages-show-message-full").css("height"))+10,10),$("#visuals-spread-hosts-permalink-link").bind("click",function(){return $("#visuals-spread-hosts-permalink-link").hide(),$("#visuals-spread-hosts-permalink-content").show(),!1}),$("#analytics-new-messages-update-range").numeric(),$("#analytics-new-messages-update-submit").bind("click",function(){return i=$("#analytics-new-messages-update-range"),v=parseInt(i.val(),10),v<=0?!1:($("#range_type_days").attr("checked")?(range_type="days",range_num=v*24):$("#range_type_weeks").attr("checked")?(range_type="weeks",range_num=v*24*7):(range_type="hours",range_num=v),$("#analytics-new-messages-update-loading").show(),$.get($(this).attr("data-updateurl")+"&hours="+range_num,function(e){plot(e.data),$("#analytics-new-messages-range").html(v),$("#analytics-new-messages-range-type").html(range_type),$("#analytics-new-messages-update-loading").hide()},"json"),!1)}),$("#sidebar-hide-link").bind("click",function(){return $("#main-right").hide(),$("#main-left").animate({width:"100%"},700),!1}),$(".favorite-stream-sparkline").sparkline("html",{type:"line",width:"40px",lineColor:"#fd0c99",fillColor:"#fdd",spotColor:!1,minSpotColor:!1,maxSpotColor:!1}),$(".el-e-sparkline").sparkline("html",{type:"line",width:"70px",height:"23px",lineColor:"#fd0c99",fillColor:"#fdd",spotColor:!1,minSpotColor:!1,maxSpotColor:!1}),$(".ajaxtrigger").bind("click",function(){field=$(this),loading=$("#"+field.attr("id")+"-ajaxtrigger-loading"),done=$("#"+field.attr("id")+"-ajaxtrigger-done"),field.attr("disabled","disabled"),done.hide(),loading.show(),$.post(field.attr("data-target"),function(e){field.removeAttr("disabled"),loading.hide(),done.show()})});var e=$("#universal-search-field"),t=e.attr("data-stdval");e.val()==""&&e.val(t),e.focus(function(){e.val()==t&&e.val("")}),e.blur(function(){e.val()==""&&e.val(t)}),$("#streams-alerts-limit").numeric(),$("#streams-alerts-timespan").numeric(),$(".stream-description-change").bind("click",function(){$("#streams-description-text").hide(),$("#streams-set-description").show()}),$(".submit-link").bind("click",function(){return $(this).attr("data-nowait")==undefined&&$(this).html("Please wait..."),$(this).attr("data-confirm")==undefined?($(this).parent().submit(),!1):(confirm($(this).attr("data-confirm"))&&$(this).parent().submit(),!1)}),$("a").bind("click",function(){return $(this).hasClass("submit-link")?!1:$(this).attr("data-confirm")==undefined?!0:confirm($(this).attr("data-confirm"))?!0:!1}),bindMessageSidebarClicks(),$("#user_role").bind("change",function(){$(this).val()=="reader"?$(".users-streams").show():$(".users-streams").hide()}),$("#sidebar").css("height",$(window).height()-120),$(".facilities-edit-link").bind("click",function(){return $(this).hide(),$(this).parent().next().show(),!1}),$("#messages-quickfilter-add-additional").bind("click",function(){return field="<dt><input name='filters[additional][keys][]' type='text' class='messages-quickfilter-additional-key' /></dt>",field+="<dd><input name='filters[additional][values][]' type='text' class='messages-quickfilter-additional-value' /></dd>",$("#messages-quickfilter-fields").append(field),reloadAutoCompleteAdditionalFields(),!1}),$("#health-show-all-indices").bind("click",function(){return $(this).hide(),$("#health-indices-more").slideDown(),!1}),$("#stream-outputs-chooser").bind("change",function(){$(".stream-output-fields").hide(),$("#stream-output-fields-"+$(this).val().replace(/\./g,"_")).show()}),$(".stream-output-edit-link").bind("click",function(){return $("#stream-output-edit-"+$(this).attr("data-output-id")).toggle(),!1}),$(".stream-rule-edit-link").bind("click",function(){return $("#stream-rule-edit-"+$(this).attr("data-rule-id")).toggle(),!1});var n=function(e){if($(e).attr("class")=="messages-link")return $(e).attr("data-modal")&&$("#messages-show-terms-modal").modal({overlayClose:!0}),$(e).attr("data-confirm")?confirm($(e).attr("data-confirm"))?!0:!1:!0};$("#sidebar-inner").delegate("a","click",function(e){n(this)}),$("#content-inner").delegate("a","click",function(e){n(this)});var r;setInterval(function(){$.get("/health/currentthroughput",function(e){r=$(".health-throughput-current"),r.html(parseInt(e.count)),r.fadeOut(200,function(){r.fadeIn(200)})},"json")},5e3)});